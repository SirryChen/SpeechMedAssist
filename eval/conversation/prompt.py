# ========== patient ============

patient_desc_prompt_MedDG = """
原始真实对话：
{base_info}

上述是【一名病人与医生的完整真实对话】。  
现在你将**扮演该患者**，以原始对话为背景，与医生开始新的交流。

你的任务：生成**开场的病情描述**（可附带一个问题），遵循以下规则：

### 输出规则
1. **字数限制**  
   - 病情描述必须**在50字以内**。

2. **信息控制**  
   - 只能透露**部分病情信息**，不得一次性说出所有症状或细节。  
   - 必须包含最基本的就诊信息（如主要症状或持续时间）。  
   - 留出更多信息等待医生追问再提供。

3. **可选提问**  
   - 可以附加一个简短的问题给医生。  
   - 如果不提问，则直接结束病情描述。

4. **输出要求**  
   - 只输出病人的开场白，不包含任何解释、推理或系统提示。
"""


patient_reply_prompt_MedDG = """
原始真实对话：
{base_info}

上述是【一名病人与医生的真实完整对话】。  
现在你将**扮演这位患者**，并以原始对话为背景，与医生继续交流。  

以下是你与医生的【历史对话】：
{history_conv_text}

【注意】历史对话的最后一句是医生的最新回复，其中可能包含：  
- 对你病情的分析  
- 对你提出的进一步问题  
- 初步的治疗建议  
- 明确的诊断结果  

### 你的任务
根据原始对话和历史对话，立即生成下一句患者的回复，遵循以下规则：

1. **优先回答医生的问题**
   - 如果医生有提问，必须基于基本资料给出准确、直接的回答。
   - 不得回避或模糊回答。

2. **可选补充**
   - 可以补充之前**未提到**的新症状或感受。
   - 如果有疑惑，可以向医生提问。
   - 必须简洁清楚。

3. **禁止重复**
   - 不要重复历史对话中已提到的症状或信息。
   - 不要重复感谢医生。

4. **字数限制**
   - 回复总字数必须**不超过100字**。

5. **结束条件**  
   - 如果历史对话中已涵盖原始对话的重要信息，  
     或医生已经清晰完整地分析你的症状、给出诊断和治疗建议， 
     或已经开始互相表达感谢， 
     则**只输出**：<结束对话>（不要再说任何其他内容）。

### 输出要求
- 只输出患者的回复内容，不要添加说明，**不得重复患者的历史回复**。
- 不要输出任何系统提示、分析过程或其他解释。
"""


patient_desc_prompt_AIHospital = """
你是一名病人。这是你的基本资料：
{base_info}

现在你将以此资料为背景，与医生开始新的对话。

你的任务：生成**开场的病情描述**（可附带一个问题），遵循以下规则：

### 输出规则
1. **字数限制**  
   - 病情描述必须**在100字以内**。

2. **信息控制**  
   - 只能透露**部分病情信息**，不得一次性说出所有症状或细节。  
   - 必须包含最基本的就诊信息（如主要症状或持续时间）。  
   - 其他重要信息留待医生进一步询问时再提供。

3. **可选提问**  
   - 可以附加一个简短的问题给医生。  
   - 如果不提问，则直接结束病情描述。

4. **输出要求**  
   - 只输出病人的开场白，不包含任何解释、推理或系统提示。
"""


patient_reply_prompt_AIHospital = """
你是一名病人。这是你的基本资料：
{base_info}

请以此资料为背景，与医生继续对话。

以下是你与医生的【历史对话】：
{history_conv_text}

【注意】历史对话的最后一句是医生的最新回复，可能包括：
- 对病情的分析
- 对你提出的进一步问题
- 初步的治疗建议
- 明确的诊断结果

### 回复规则
1. **优先回答医生的问题**
   - 如果医生有提问，必须基于基本资料给出准确、直接的回答。
   - 不得回避或模糊回答。

2. **可选补充**
   - 可以补充之前**未提到**的新症状或感受。
   - 如果有疑惑，可以向医生提问。
   - 必须简洁清楚。

3. **禁止重复**
   - 不要重复历史对话中已提到的症状或信息。
   - 不要重复感谢医生。

4. **字数限制**
   - 回复总字数必须**不超过100字**。

5. **结束条件**  
   - 如果历史对话中已涵盖原始对话的重要信息，  
     或医生已经清晰完整地分析你的症状、给出诊断和治疗建议， 
     或已经开始互相表达感谢， 
     则**只输出**：<结束对话>（不要再说任何其他内容）。

### 输出要求
- 只输出患者的回复内容，不要添加说明，**不得重复患者的历史回复**。
- 不要输出任何系统提示、分析过程或其他解释。
"""

# ========== judge ============

judge_single_prompt_MedDG = """
你是一名资深临床医学专家。  
你的任务是基于患者与实习医生之间的多轮问诊交流，对实习医生的表现进行客观、严谨的评分。   
需保持统一的评分标准，避免因个人偏好产生偏差。

【评分原则】  
- 每个维度满分为 10 分，0 分代表完全不符合要求，10 分代表完全符合要求，按 1 分递增。   
- 患者与医生的对话背景是在日常生活中，应该整体上符合日常交流特点，评估时请注意这一背景。 

【评价维度及标准】  

1. 症状理解与提取
- 能够正确理解患者提供的症状，回复与患者症状相关联
- 在已知症状适中时，若给出疾病猜测，是否与已知的病症具有相关性
- 在已知症状较少时，若存在追问，其中涉及的问题应该与已知病症具有相关性

2. 主动追问
- 在无法做出初步的疾病猜测时，是否针对核心症状提出必要的追问
- 追问问题应该符合逻辑，有利于得出诊断结果
- 若没有提问，则扣分

3. 诊断流程合理性
- 能否根据已有症状给出一个初步的病情分析或疾病诊断
- 可以先给出一个疾病猜想，再经过对话更正
- 最终的疾病诊断或治疗建议是否符合患者已有的症状
- 诊断基于语音对话，不需要深入分析与解释
- 若病情可能危重，可以建议患者尽快就医

4. 治疗建议合理性与简洁性
- 建议应符合循证医学与临床安全规范  
- 在信息较为充足，病因基本明确时，给出治疗建议和用药建议
- 请检查用药建议是否正确  
- 治疗建议应该简短清晰，便于理解，不能过于冗长复杂

5. 对话结构与沟通质量  
- 交流过程是否结构清晰、逻辑连贯
- 用词通俗简单，医生回复不机械，符合日常交流的特点  
- 医患之间一问一答，高效简洁，层层递进，最终获得诊断结果
- 在必要时对患者进行情绪抚慰，减少焦虑
- 若患者重复反馈相同信息或表达感谢，这是记录时的错误，可以忽视

6. 符合语音对话特点  
- 语气是否自然、易于理解，符合口语表达习惯  
- 不包含不能发音的标点符号，**不能分列多个点**  
- 单次回复长度符合日常语音交流单方一次交流的回复长度（例如100字）

以下是患者与实习医生的对话：  
{dialogue}

【任务要求】  
请仅基于上述标准对对话进行评分，严格按照每个维度的具体评分细则，且不同的评分维度之间互不干扰，不得添加额外的主观推测或无关信息。  
确保评分理由简洁、明确、基于对话事实。不同实习医生给出的回复长度不同，但不能对回复长度有偏好。


请严格按照以下格式输出：  
<症状理解与提取>: X/10 - 理由  
<主动追问>: X/10 - 理由  
<诊断流程合理性>: X/10 - 理由  
<治疗建议合理性与简洁性>: X/10 - 理由  
<对话结构与沟通质量>: X/10 - 理由  
<符合语音对话特点>: X/10 - 理由
"""

judge_single_dimensions_MedDG = [
    "症状理解与提取",
    "主动追问",
    "诊断流程合理性",
    "治疗建议合理性与简洁性",
    "对话结构与沟通质量",
    "符合语音对话特点"
]


judge_single_prompt_AIHospital = """
你是一名资深临床医学专家。  
你的任务是基于患者与实习医生之间的多轮问诊交流，对实习医生的表现进行客观、严谨的评分。   
需保持统一的评分标准，避免因个人偏好产生偏差。

【评分原则】  
- 每个维度满分为 10 分，0 分代表完全不符合要求，10 分代表完全符合要求，按 1 分递增。   
- 患者与医生的对话背景是在日常生活中，应该整体上符合日常交流特点，评估时请注意这一背景。 

【评价维度及标准】  

1. 症状理解与提取
- 能够正确理解患者提供的症状，回复与患者症状相关联
- 在已知症状适中时，若给出疾病猜测，是否与已知的病症具有相关性
- 在已知症状较少时，若存在追问，其中涉及的问题应该与已知病症具有相关性

2. 主动追问
- 在无法做出初步的疾病猜测时，是否针对核心症状提出必要的追问
- 追问问题应该符合逻辑，有利于得出诊断结果
- 若没有提问，则扣分

3. 诊断流程合理性
- 能否根据已有症状给出一个初步的病情分析或疾病诊断
- 可以先给出一个疾病猜想，再经过对话更正
- 最终的疾病诊断或治疗建议是否符合患者已有的症状
- 诊断基于语音对话，不需要深入分析与解释
- 若病情可能危重，可以建议患者尽快就医

4. 治疗建议合理性与简洁性
- 建议应符合循证医学与临床安全规范  
- 在信息较为充足，病因基本明确时，给出治疗建议和用药建议
- 请检查用药建议是否正确  
- 治疗建议应该简短清晰，便于理解，不能过于冗长复杂

5. 对话结构与沟通质量  
- 交流过程是否结构清晰、逻辑连贯
- 用词通俗简单，医生回复不机械，符合日常交流的特点  
- 医患之间一问一答，高效简洁，层层递进，最终获得诊断结果
- 在必要时对患者进行情绪抚慰，减少焦虑
- 若患者重复反馈相同信息或表达感谢，这是记录时的错误，可以忽视

6. 符合语音对话特点  
- 语气是否自然、易于理解，符合口语表达习惯  
- 不包含不能发音的标点符号，**不能分列多个点**  
- 单次回复长度符合日常语音交流单方一次交流的回复长度（例如100字）

以下是患者与实习医生的对话：  
{dialogue}

【任务要求】  
请仅基于上述标准对对话进行评分，严格按照每个维度的具体评分细则，且不同的评分维度之间互不干扰，不得添加额外的主观推测或无关信息。  
确保评分理由简洁、明确、基于对话事实。不同实习医生给出的回复长度不同，但不能对回复长度有偏好。


请严格按照以下格式输出：  
<症状理解与提取>: X/10 - 理由  
<主动追问>: X/10 - 理由  
<诊断流程合理性>: X/10 - 理由  
<治疗建议合理性与简洁性>: X/10 - 理由  
<对话结构与沟通质量>: X/10 - 理由  
<符合语音对话特点>: X/10 - 理由
"""

judge_single_dimensions_AIHospital = [
    "症状理解与提取",
    "主动追问",
    "诊断流程合理性",
    "治疗建议合理性与简洁性",
    "对话结构与沟通质量",
    "符合语音对话特点"
]


judge_compare_prompt = """
你是资深的医学专家。  
你的任务是仔细阅读患者与两位实习医生（对话A 和 对话B）之间的多轮问诊对话，并根据给定的评价维度，对二者的表现进行全面、专业的比较评估。  
患者为同一人，基础症状和病情背景一致。  
只能基于对话中明确提供的信息进行评价，不得进行超出对话内容的假设或推测。  
请保持评价标准一致，确保评判具有医学专业性与客观性。  

【评价维度】

1. 症状理解与提取
- 能够正确理解患者提供的症状，回复与患者症状相关联 
- 在已知症状较少时，追问中涉及的病症与已知病症具有相关性
- 不能在信息不充分时（例如第一轮对话中）随意给出猜测或诊断结果

2. 主动追问与情绪抚慰  
- 是否针对核心症状提出必要的追问
- 追问问题应该符合逻辑，有利于得出诊断结果
- 在必要时对患者进行情绪抚慰，减少焦虑

3. 初步诊断结果合理性
- 能否根据已有症状给出一个初步的病情分析或疾病诊断
- 该病情分析或疾病诊断是否符合患者已有的症状
- 诊断基于语音对话，不需要深入分析与推理

4. 治疗建议合理性与简洁性
- 建议应符合循证医学与临床安全规范  
- 在信息较为充足，病因基本明确时，给出治疗建议和用药建议
- 请检查用药建议是否正确  
- 治疗建议应该简短清晰，便于理解，不能过于冗长复杂

5. 对话结构与沟通质量  
- 交流过程是否结构清晰、逻辑连贯
- 用词通俗简单，符合日常交流的特点  
- 医患之间一问一答，层层递进，最终获得诊断结果

6. 符合语音对话特点  
- 语气是否自然、易于理解，符合口语表达习惯  
- 不包含不能发音的标点符号，**不能分列多个点**  
- 单次回复长度符合日常语音交流单方一次交流的回复长度（例如100字）

以下是同一个患者分别与两位实习医生的对话：  
对话A：  
{dialogue_a}  

对话B：  
{dialogue_b}  

【输出要求】  
1. 按上述6个维度，分别对A和B进行逐项比较，说明谁在该维度表现更好以及理由  
2. 在综合所有维度后，明确判断：A更好 / B更好 / 打平，并给出简洁的综合理由  

【输出格式】  
<症状理解与提取>: [A好/B好/打平] - 理由  
<主动追问与情绪抚慰>: [A好/B好/打平] - 理由  
<初步诊断结果合理性>: [A好/B好/打平] - 理由  
<治疗建议合理性与简洁性>: [A好/B好/打平] - 理由  
<对话结构与沟通质量>: [A好/B好/打平] - 理由  
<符合语音对话特点>: [A好/B好/打平] - 理由  

<综合结论>: [A好/B好/打平] - 综合理由

"""

judge_compare_dimensions = [
    "症状理解与提取",
    "主动追问与情绪抚慰",
    "初步诊断结果合理性",
    "治疗建议合理性与简洁性",
    "对话结构与沟通质量",
    "符合语音对话特点",
    "综合结论"
]
